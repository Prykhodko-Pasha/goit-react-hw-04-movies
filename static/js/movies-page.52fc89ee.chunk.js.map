{"version":3,"sources":["services/movies-api.js","components/MoviesGallery/MoviesGallery.module.css","components/MoviesGalleryItem/MoviesGalleryItem.module.css","components/Button/Button.js","components/Button/Button.module.css","components/MoviesGalleryItem/MoviesGalleryItem.js","components/MoviesGallery/MoviesGallery.js","components/Searchbar/Searchbar.module.css","components/Searchbar/Searchbar.js","components/MoviesPage/MoviesPage.js"],"names":["BASE_URL","API_KEY","fetchTrendingMovies","pageNumber","fetch","then","response","json","catch","error","Promise","reject","fetchSearchingMovies","searchQuery","fetchMovieById","movieId","fetchMovieReviews","fetchMovieCast","console","log","module","exports","Button","onLoadMore","type","className","s","onClick","MoviesGalleryItem","id","poster_path","title","release_date","year","slice","src","alt","MoviesGalleryItem__image","MoviesGalleryItem__descr","MoviesGalleryItem__name","MoviesGalleryItem__year","MoviesGallery","moviesArr","url","useRouteMatch","pathTo","includes","location","useLocation","map","index","to","pathname","state","from","Searchbar","onSearch","useState","query","setQuery","SearchForm","onSubmit","e","preventDefault","SearchForm__button","style","width","height","SearchForm__button__label","SearchForm__input","autoComplete","autoFocus","placeholder","onChange","currentTarget","value","trim","MoviesPage","setSearchQuery","movies","setMovies","status","setStatus","setPageNumber","showLoadMoreBtn","setShowLoadMoreBtn","errorMessage","setErrorMessage","history","useHistory","queryParam","URLSearchParams","search","get","useEffect","data","results","length","totalPages","Math","ceil","total_pages","usableMovieKeysArr","prevMovies","err","window","scrollTo","top","document","documentElement","scrollHeight","innerHeight","behavior","push","Loader"],"mappings":"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","file":"static/js/movies-page.52fc89ee.chunk.js","sourcesContent":["const BASE_URL = 'https://api.themoviedb.org/3';\r\nconst API_KEY = '352acb8d318346b404dce557309fb342';\r\n\r\nexport function fetchTrendingMovies(pageNumber) {\r\n  return fetch(\r\n    `${BASE_URL}/trending/movie/week?api_key=${API_KEY}&page=${pageNumber}`,\r\n  )\r\n    .then(response => response.json())\r\n    .catch(error => Promise.reject(error));\r\n}\r\n\r\nexport function fetchSearchingMovies(searchQuery, pageNumber) {\r\n  return fetch(\r\n    `${BASE_URL}/search/movie?api_key=${API_KEY}&query=${searchQuery}&page=${pageNumber}`,\r\n  )\r\n    .then(response => response.json())\r\n    .catch(error => Promise.reject(error));\r\n}\r\n\r\nexport function fetchMovieById(movieId) {\r\n  return fetch(`${BASE_URL}/movie/${movieId}?api_key=${API_KEY}&language=en-US`)\r\n    .then(response => response.json())\r\n    .catch(error => Promise.reject(error));\r\n}\r\n\r\nexport function fetchMovieReviews(movieId) {\r\n  return fetch(`${BASE_URL}/movie/${movieId}/reviews?api_key=${API_KEY}`)\r\n    .then(response => response.json())\r\n    .catch(error => Promise.reject(error));\r\n}\r\n\r\nexport function fetchMovieCast(movieId) {\r\n  console.log(`${BASE_URL}/movie/${movieId}/credits?api_key=${API_KEY}`);\r\n  return fetch(`${BASE_URL}/movie/${movieId}/credits?api_key=${API_KEY}`)\r\n    .then(response => response.json())\r\n    .catch(error => Promise.reject(error));\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"MoviesGallery\":\"MoviesGallery_MoviesGallery__1hFKr\",\"MoviesGalleryItem\":\"MoviesGallery_MoviesGalleryItem__7a9xO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"MoviesGalleryItem__image\":\"MoviesGalleryItem_MoviesGalleryItem__image__3Vxgj\",\"MoviesGalleryItem__descr\":\"MoviesGalleryItem_MoviesGalleryItem__descr__2N6JR\",\"MoviesGalleryItem__name\":\"MoviesGalleryItem_MoviesGalleryItem__name__3_Ynv\",\"MoviesGalleryItem__year\":\"MoviesGalleryItem_MoviesGalleryItem__year__dFE-r\"};","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport s from './Button.module.css';\r\n\r\nexport default function Button({ onLoadMore }) {\r\n  return (\r\n    <button type=\"button\" className={s.Button} onClick={onLoadMore}>\r\n      Load more\r\n    </button>\r\n  );\r\n}\r\n\r\nButton.propTypes = {\r\n  onLoadMore: PropTypes.func.isRequired,\r\n};\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Button\":\"Button_Button__7CmtT\"};","import PropTypes from 'prop-types';\r\nimport s from './MoviesGalleryItem.module.css';\r\n\r\nexport default function MoviesGalleryItem({\r\n  id,\r\n  poster_path,\r\n  title,\r\n  release_date,\r\n}) {\r\n  const year = release_date ? release_date.slice(0, 4) : '0000';\r\n\r\n  return (\r\n    <>\r\n      <img\r\n        id={id}\r\n        src={\r\n          poster_path\r\n            ? `https://image.tmdb.org/t/p/w500${poster_path}`\r\n            : 'https://artismedia.by/blog/wp-content/uploads/2018/05/in-blog2-1.png'\r\n        }\r\n        alt=\"\"\r\n        className={s.MoviesGalleryItem__image}\r\n      />\r\n      <div className={s.MoviesGalleryItem__descr}>\r\n        <p className={s.MoviesGalleryItem__name}>{title}</p>\r\n        <p className={s.MoviesGalleryItem__year}>{year}</p>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nMoviesGalleryItem.propTypes = {\r\n  id: PropTypes.number.isRequired,\r\n  poster_path: PropTypes.string,\r\n  title: PropTypes.string.isRequired,\r\n  release_date: PropTypes.string.isRequired,\r\n};\r\n","import { Link, useRouteMatch, useLocation } from 'react-router-dom';\r\nimport PropTypes from 'prop-types';\r\nimport s from './MoviesGallery.module.css';\r\nimport MoviesGalleryItem from '../MoviesGalleryItem/MoviesGalleryItem';\r\n\r\nexport default function MoviesGallery({ moviesArr }) {\r\n  // const BASE_URL = 'goit-react-hw-04-movies';\r\n  const { url } = useRouteMatch();\r\n  const pathTo = url.includes('/movies') ? url : `${url}movies`;\r\n  const location = useLocation();\r\n\r\n  return (\r\n    <ul className={s.MoviesGallery}>\r\n      {moviesArr.map(({ id, poster_path, title, release_date }, index) => (\r\n        <Link\r\n          to={{\r\n            pathname: `${pathTo}/${id}`,\r\n            state: { from: location },\r\n          }}\r\n          key={index}\r\n          className={s.MoviesGalleryItem}\r\n        >\r\n          <MoviesGalleryItem\r\n            id={id}\r\n            poster_path={poster_path}\r\n            title={title}\r\n            release_date={release_date}\r\n          />\r\n        </Link>\r\n      ))}\r\n    </ul>\r\n  );\r\n}\r\n\r\nMoviesGallery.propTypes = {\r\n  moviesArr: PropTypes.arrayOf(PropTypes.object).isRequired,\r\n};\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Searchbar\":\"Searchbar_Searchbar__1BnZ8\",\"SearchForm\":\"Searchbar_SearchForm__1d_dh\",\"SearchForm__button\":\"Searchbar_SearchForm__button__p1Ikf\",\"SearchForm__button__label\":\"Searchbar_SearchForm__button__label__3L929\",\"SearchForm__input\":\"Searchbar_SearchForm__input__kR49j\"};","import React, { useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport s from './Searchbar.module.css';\r\nimport { AiOutlineSearch } from 'react-icons/ai';\r\n\r\nexport default function Searchbar({ onSearch }) {\r\n  const [query, setQuery] = useState('');\r\n\r\n  const onChange = e => {\r\n    setQuery(e.currentTarget.value.trim());\r\n  };\r\n\r\n  const onSubmit = e => {\r\n    e.preventDefault();\r\n    onSearch(query);\r\n  };\r\n\r\n  return (\r\n    <div className={s.Searchbar}>\r\n      <form className={s.SearchForm} onSubmit={onSubmit}>\r\n        <button type=\"submit\" className={s.SearchForm__button}>\r\n          <AiOutlineSearch style={{ width: '70%', height: '70%' }} />\r\n          <span className={s.SearchForm__button__label}>Search</span>\r\n        </button>\r\n\r\n        <input\r\n          className={s.SearchForm__input}\r\n          type=\"text\"\r\n          autoComplete=\"off\"\r\n          autoFocus\r\n          placeholder=\"Search movies...\"\r\n          onChange={onChange}\r\n        />\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nSearchbar.propTypes = {\r\n  onSearch: PropTypes.func.isRequired,\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useHistory, useLocation } from 'react-router-dom';\r\nimport { fetchSearchingMovies } from '../../services/movies-api';\r\nimport Searchbar from '../Searchbar/Searchbar';\r\nimport Loader from '../Loader/Loader';\r\nimport MoviesGallery from '../MoviesGallery/MoviesGallery';\r\nimport Button from '../Button/Button';\r\n\r\nexport default function MoviesPage() {\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [movies, setMovies] = useState([]);\r\n  const [status, setStatus] = useState('idle');\r\n  const [pageNumber, setPageNumber] = useState(1);\r\n  const [showLoadMoreBtn, setShowLoadMoreBtn] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState('');\r\n\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n  const searchParams = new URLSearchParams(location.search);\r\n  // console.log(searchParams);\r\n  const queryParam = searchParams.get('query');\r\n  // console.log(searchParamFromURL);\r\n\r\n  useEffect(() => {\r\n    queryParam && setSearchQuery(queryParam);\r\n  }, [queryParam]);\r\n\r\n  useEffect(() => {\r\n    if (!searchQuery) return; //отменяем первый рендер или рендер пустой строки\r\n\r\n    setStatus('pending');\r\n\r\n    fetchSearchingMovies(searchQuery, pageNumber)\r\n      .then(data => {\r\n        if (data.results.length === 0) {\r\n          setStatus('rejected');\r\n          setErrorMessage('There are no movies for this query :(');\r\n        } else {\r\n          const totalPages = Math.ceil(data.total_pages / 12);\r\n          const usableMovieKeysArr = data.results.map(\r\n            ({ id, poster_path, title, release_date }) => {\r\n              return {\r\n                id,\r\n                poster_path,\r\n                title,\r\n                release_date,\r\n              };\r\n            },\r\n          );\r\n\r\n          setMovies(prevMovies => [...prevMovies, ...usableMovieKeysArr]);\r\n          setStatus('resolved');\r\n          setShowLoadMoreBtn(totalPages === pageNumber ? false : true);\r\n        }\r\n      })\r\n      .catch(err => {\r\n        setStatus('rejected');\r\n        setErrorMessage(`There is an error: ${err}`);\r\n      });\r\n\r\n    window.scrollTo({\r\n      top: document.documentElement.scrollHeight - window.innerHeight,\r\n      behavior: 'smooth',\r\n    });\r\n  }, [searchQuery, pageNumber]);\r\n\r\n  const onSearch = query => {\r\n    setSearchQuery(query);\r\n    setMovies([]);\r\n    setPageNumber(1);\r\n    history.push(`?query=${query}`);\r\n  };\r\n\r\n  const onLoadMore = () => {\r\n    setPageNumber(pageNumber + 1);\r\n    setStatus('pending');\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Searchbar onSearch={onSearch} />\r\n      {status === 'pending' && (\r\n        <>\r\n          {movies.length !== 0 && <MoviesGallery moviesArr={movies} />}\r\n          <div style={{ height: '60vh' }}>\r\n            <Loader />\r\n          </div>\r\n          <div className=\"loadMoreReplacer\"></div>\r\n        </>\r\n      )}\r\n      {status === 'rejected' && <p className=\"Msg\">{errorMessage}</p>}\r\n      {status === 'resolved' && (\r\n        <>\r\n          <MoviesGallery moviesArr={movies} />\r\n          {showLoadMoreBtn && <Button onLoadMore={onLoadMore} />}\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n"],"sourceRoot":""}